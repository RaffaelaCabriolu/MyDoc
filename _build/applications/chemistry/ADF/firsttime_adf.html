

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>First time you run an ADF job? &mdash; HPC Physics documentation 0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> HPC Physics documentation
          

          
          </a>

          
            
            
              <div class="version">
                0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../clusters/getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../news/news.html">News and notifications</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting help</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../help/contact.html">Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../help/staff.html">Support staff and Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../help/tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../help/faq.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../help/hpc-qa-sessions.html">Forum, Open Question &amp; Answer Sessions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Jobs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../jobs/dos_and_donts.html">Dos and don’ts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../jobs/batch.html">Batch system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../jobs/examples.html">Job script examples</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../jobs/slurm_parameter.html">SLURM Workload Manager</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../jobs/job_management.html">Managing jobs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../jobs/monitoring.html">Monitoring your jobs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../jobs/running_mpi_jobs.html">Running MPI jobs</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">HPC Physics documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
      <li>First time you run an ADF job?</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/applications/chemistry/ADF/firsttime_adf.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="first-time-you-run-an-adf-job">
<span id="first-time-adf"></span><h1>First time you run an ADF job?<a class="headerlink" href="#first-time-you-run-an-adf-job" title="Permalink to this headline">¶</a></h1>
<p>This page contains info aimed at first time
users of ADF on Stallo, but may also be usefull to
more experienced users. Please look carefully through the
provided examples. Also note that the job-script example is rather richly
commented to provide additional and relevant info.</p>
<p>If you want to run this testjob, download the copies of the scripts and put them
into your test job folder (which I assume you have created in advance).</p>
<section id="adf-input-example">
<h2>ADF input example<a class="headerlink" href="#adf-input-example" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">title</span> <span class="n">Caffeine</span> <span class="k">for</span> <span class="n">scale</span> <span class="n">testing</span>
<span class="n">integration</span>  <span class="mf">6.0</span>
<span class="n">units</span>
<span class="n">length</span> <span class="n">angstrom</span>
<span class="n">end</span>
<span class="n">symmetry</span>  <span class="n">Nosym</span>
<span class="n">atoms</span> <span class="n">cartesian</span>
<span class="n">C</span>     <span class="mf">1.179579</span>     <span class="mf">0.000000</span>    <span class="o">-</span><span class="mf">0.825950</span>
<span class="n">C</span>     <span class="mf">2.359623</span>     <span class="mf">0.000000</span>     <span class="mf">0.016662</span>
<span class="n">C</span>     <span class="mf">2.346242</span>     <span class="mf">0.000000</span>     <span class="mf">1.466600</span>
<span class="n">N</span>     <span class="mf">1.092573</span>     <span class="mf">0.000000</span>     <span class="mf">2.175061</span>
<span class="n">C</span>     <span class="mf">0.000000</span>     <span class="mf">0.000000</span>     <span class="mf">1.440000</span>
<span class="n">N</span>     <span class="mf">0.000000</span>     <span class="mf">0.000000</span>     <span class="mf">0.000000</span>
<span class="n">N</span>     <span class="mf">3.391185</span>     <span class="mf">0.000000</span>     <span class="mf">1.965657</span>
<span class="n">C</span>     <span class="mf">4.217536</span>     <span class="mf">0.000000</span>     <span class="mf">1.154419</span>
<span class="n">N</span>     <span class="mf">3.831536</span>     <span class="mf">0.000000</span>     <span class="mf">0.062646</span>
<span class="n">C</span>     <span class="mf">4.765176</span>    <span class="o">-</span><span class="mf">0.384157</span>    <span class="o">-</span><span class="mf">0.964164</span>
<span class="n">C</span>     <span class="mf">1.058378</span>    <span class="o">-</span><span class="mf">0.322767</span>     <span class="mf">3.578004</span>
<span class="n">O</span>    <span class="o">-</span><span class="mf">1.345306</span>     <span class="mf">0.000000</span>     <span class="mf">1.827493</span>
<span class="n">C</span>    <span class="o">-</span><span class="mf">1.260613</span>    <span class="o">-</span><span class="mf">0.337780</span>    <span class="o">-</span><span class="mf">0.608570</span>
<span class="n">O</span>     <span class="mf">1.192499</span>     <span class="mf">0.000000</span>    <span class="o">-</span><span class="mf">2.225890</span>
<span class="n">H</span>    <span class="o">-</span><span class="mf">1.997518</span>    <span class="o">-</span><span class="mf">0.535233</span>     <span class="mf">0.168543</span>
<span class="n">H</span>    <span class="o">-</span><span class="mf">1.598963</span>     <span class="mf">0.492090</span>    <span class="o">-</span><span class="mf">1.227242</span>
<span class="n">H</span>    <span class="o">-</span><span class="mf">1.138698</span>    <span class="o">-</span><span class="mf">1.225644</span>    <span class="o">-</span><span class="mf">1.227242</span>
<span class="n">H</span>     <span class="mf">0.031688</span>    <span class="o">-</span><span class="mf">0.271264</span>     <span class="mf">3.937417</span>
<span class="n">H</span>     <span class="mf">1.445570</span>    <span class="o">-</span><span class="mf">1.329432</span>     <span class="mf">3.728432</span>
<span class="n">H</span>     <span class="mf">1.672014</span>     <span class="mf">0.388303</span>     <span class="mf">4.129141</span>
<span class="n">H</span>     <span class="mf">4.218933</span>    <span class="o">-</span><span class="mf">0.700744</span>    <span class="o">-</span><span class="mf">1.851470</span>
<span class="n">H</span>     <span class="mf">5.400826</span>     <span class="mf">0.464419</span>    <span class="o">-</span><span class="mf">1.212737</span>
<span class="n">H</span>     <span class="mf">5.381834</span>    <span class="o">-</span><span class="mf">1.206664</span>    <span class="o">-</span><span class="mf">0.604809</span>
<span class="n">H</span>     <span class="mf">5.288201</span>     <span class="mf">0.000000</span>     <span class="mf">1.353412</span>
<span class="n">end</span>

<span class="n">BASIS</span>
<span class="n">Type</span> <span class="n">TZ2P</span>
<span class="n">End</span>

<span class="n">geometry</span>
<span class="n">end</span>
<span class="n">scf</span>
<span class="n">end</span>
<span class="n">unrestricted</span>

<span class="n">charge</span> <span class="mi">0</span> <span class="mi">0</span>

<span class="n">xc</span>
<span class="n">gga</span> <span class="n">PW91</span>
<span class="n">end</span>

<span class="n">noprint</span> <span class="n">frag</span> <span class="n">sfo</span>

<span class="n">endinput</span>
</pre></div>
</div>
<p>This file can also be downloaded here: <a class="reference download internal" download="" href="../../../_downloads/df72293a75d9b17472f9d80df62b614f/caffeine.adf"><code class="xref download docutils literal notranslate"><span class="pre">Caffeine</span> <span class="pre">input</span> <span class="pre">for</span> <span class="pre">ADF</span></code></a>.</p>
<p>Place this file in a job folder of choice, say ADFFIRSTJOB in your home directory on Stallo.</p>
<p>then, copy the job-script as seen here:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/bash -l

################### ADF Job Batch Script Example ###################
# Section for defining queue-system variables:
#-------------------------------------
# This script asks for a given set of cores nodes and cores. Stallo has got 16 or 20 cores/node,
# asking for something that adds up to both is our general recommodation (80, 160 etc), you would
# then need to use --ntasks instead of --nodes and --ntasks-per-node. (replace both).
# Runtime for this job is 59 minutes; syntax is hh:mm:ss.
# Memory is set to the maximum advised for a full node, 1500MB/core - giving a total
# of 30000MB/node and leaving some for the system to use. Memory
# can be specified pr core, virtual or total pr job (be carefull).
#-------------------------------------
# SLURM-section
#SBATCH --job-name=adf_runex
#SBATCH --nodes=2
#SBATCH --ntasks-per-node=20
#SBATCH --time=00:59:00
#SBATCH --mem-per-cpu=1500MB # Be ware of memory needs, might be a lot higher if you are running Zora basis, for example.
#SBATCH --output=adf_runex.log
#SBATCH --mail-type=ALL
#SBATCH --exclusive
#SBATCH --partition=multinode

######################################
# Section for defining job variables and settings:

input=caffeine # Name of input without extention
ext=adf # We use the same naming scheme as the software default, also for extention
cores=$SLURM_NTASKS  # Number of cores potentially used by mpi engine in submit procedure

# We load all the default program system settings with module load:

module --quiet purge
module load ADF/adf2017.108

# Now we create working directory and temporary scratch for the job(s):
# Necessary variables are defined in the notur and the software modules.

export SCM_TMPDIR=/global/work/$USER/$SLURM_JOBID
mkdir -p $SCM_TMPDIR

# Preparing and moving inputfiles to tmp:

submitdir=$SLURM_SUBMIT_DIR

cp ${input}.${ext} $SCM_TMPDIR
cd $SCM_TMPDIR

# In case necessary, set SCM_IOBUFFERSIZE
#export SCM_IOBUFFERSIZE=1024 # Or higher if necessary.

######################################
# Section for running the program and cleaning up:

# Running the program:

time adf -n $cores &lt; ${input}.${ext} &gt; adf_$input.out

# Cleaning up and moving files back to home/submitdir:
# Make sure to move all essential files specific for the given job/software.

cp adf_$input.out $submitdir/adf_$input.out
cp TAPE21 $submitdir/$input.t21

# To zip some of the output might be a good idea!
#gzip $input.t21
#mv $input.t21.gz $submitdir/

# Investigate potentially other files to keep:
echo $(pwd)
echo $(ls -ltr)

# ALWAYS clean up after yourself. Please do uncomment the following line
#cd $submitdir
#rm -r $tempdir/*

echo &quot;Job finished at&quot;
date
################### Job Ended ###################
exit 0
</pre></div>
</div>
<p>(Can also be downloaded from here: <a class="reference download internal" download="" href="../../../_downloads/fa00b46f464d85afd578d0ba9d779297/job_adf.sh"><code class="xref download docutils literal notranslate"><span class="pre">job_adf.sh</span></code></a>)</p>
<p>Place this script in the same folder and type:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sbatch job_adf.sh
</pre></div>
</div>
<p>You may now have submitted your first adf job.</p>
</section>
<section id="these-files-are-also-available-on-stallo">
<h2>These files are also available on Stallo<a class="headerlink" href="#these-files-are-also-available-on-stallo" title="Permalink to this headline">¶</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>module load ADF/adf2017.108
<span class="nb">cd</span> &lt;to whatever you call your <span class="nb">test</span> folder&gt; <span class="c1"># for instance ADFFIRSTJOB</span>
cp -R /global/hds/software/notur/apprunex/ADF/* .
</pre></div>
</div>
<p>To verify that the jobs has worked fine, check the outputfile. If it says EXIT and print Bond Energies at the end of the file, you are likely on the safe side.</p>
<p>Check the Bond Energy in adf_caffeine.out. The value should ideally be close to -156.75317227 eV. When this is the case, you may alter variables in the shell script as much as you like to adapt to your own jobs.</p>
<p><strong>NB: ADF is installed as precompiled binaries, they come with their own mpi (intel MPI). So if you are not using the provided runscript example and/or loading the newer modules - please make sure that you load an intelmpi module and also preferably a rather recent intel compiler.</strong></p>
<p>Also note that, on Stallo, we hold the nbo6 plug in license that allows users of adf to produce files that can be read with the nb06 software.</p>
<p>Good luck with your chemistry!</p>
</section>
</section>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, HPC Physics group - NTNU

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>